machine:
    timezone:
        Asia/Tokyo
    environment:
        IMPORT_PATH: "github.com/${CIRCLE_PROJECT_USERNAME}/${CIRCLE_PROJECT_REPONAME}"

dependencies:
    pre:
        - go get github.com/astaxie/beego
        - go get github.com/astaxie/beego/cache
        - go get github.com/astaxie/beego/cache/redis
        - go get github.com/beego/bee
        - go get github.com/astaxie/beego/orm
        - go get github.com/lib/pq
        - go get github.com/go-sql-driver/mysql
        - go get github.com/smartystreets/goconvey/convey
    override:
        - mkdir -p "${GOPATH}/src/${IMPORT_PATH}"
        - rsync -azC --delete ./ "${GOPATH}/src/${IMPORT_PATH}"

test:
    override:
        - go test -v -race ${GOPATH}/src/${IMPORT_PATH}/tests/*
